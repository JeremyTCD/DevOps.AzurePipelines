parameters:
  buildConfiguration: ""
  extraArguments: ""
  runCodeCoverage: "false"

steps:
- checkout: "none"
- template: "../shared/download-working-directory.yml"
- task: "DotNetCoreCLI@2"
  displayName: "Test"
  inputs:
    command: "test"
    projects: "test/**/*.csproj"
    arguments: "--no-restore --no-build --configuration ${{parameters.buildConfiguration}} -p:CollectCoverage=${{parameters.runCodeCoverage}} -p:CoverletOutputFormat=cobertura ${{ parameters.extraArguments }}"
  # Skip dotnet first time experience
  env:
    DOTNET_SKIP_FIRST_TIME_EXPERIENCE: true
    # Make sure dotnet knows to look for packages in ./packages
    NUGET_PACKAGES: $(system.defaultWorkingDirectory)/packages